from google import genai

PROMPT = """You are a wildfire risk analyst. I will provide weather data for you to analyze.

Take the following data as an example for where fires have happened in the last couple of years. The last column indicates the presence of a fire.


id,date_time,latitude,longitude,temperature,dewpoint,relative_humidity,precipitation,snow,wind_direction,wind_speed,wind_gust,air_pressure,sunshine,weather_code,fire
0,12/17/2022 17:00,33.67334,-111.5616,8.3,-8.7,29.0,0.0,,30.0,11.2,,1019.8,,1.0,1
2,8/2/2022 22:12,30.59480278,-96.96620053,38.0,16.3,28.0,0.0,,200.0,24.1,,1013.0,,2.0,1
4,1/17/2022 21:31,35.18100833,-101.6982267,16.1,-12.3,13.0,0.0,,200.0,35.3,,1011.7,,,1
6,2/21/2022 21:57,32.83168581,-98.06071191,27.8,10.5,34.0,0.0,,190.0,18.4,,1005.1,,,1
8,6/28/2022 18:41,30.325,-94.02233333,31.7,20.0,50.0,0.0,,50.0,13.0,,1018.6,,3.0,1
10,3/29/2022 19:58,35.745,-100.543,30.6,-2.1,12.0,0.0,,230.0,46.4,,997.0,,,1
12,8/18/2022 1:25,32.601623,-98.597897,33.8,15.7,34.0,0.0,,38.0,11.9,,1011.6,,3.0,1
14,12/19/2022 21:39,40.03794,-105.3282,8.0,-17.9,14.0,0.0,,270.0,57.6,,1016.0,,3.0,1
16,3/20/2022 18:54,32.3588889,-98.0041667,24.0,-1.1,19.0,0.0,,140.0,25.9,,1021.0,,,1
18,8/16/2022 19:00,31.90001667,-95.43095,37.4,17.4,31.0,0.0,,187.0,6.1,,1013.0,,1.0,1
20,9/10/2022 13:20,30.962,-95.5715,22.0,19.5,86.0,0.0,,24.0,4.3,,1012.7,,1.0,1
22,7/15/2022 23:32,33.2525,-95.90888889,36.5,16.1,30.0,0.0,,100.0,20.5,,1016.0,,1.0,1
24,5/2/2021 1:21,44.0766,-111.6382,18.3,2.2,34.0,0.0,,310.0,20.5,,1003.2,,,1
26,5/20/2022 17:49,31.76333333,-99.12583333,32.0,18.9,46.0,0.0,,190.0,25.9,,1003.0,,,1
28,10/6/2022 19:52,33.59066667,-95.633,31.1,9.9,27.0,0.0,,350.0,14.8,,1019.9,,2.0,1
30,7/5/2022 2:40,43.51276,-116.279,26.7,3.8,23.0,0.0,,350.0,16.6,,1009.5,,2.0,1
32,6/27/2020 18:51,41.39848,-111.8624,30.6,1.0,15.0,,,230.0,7.6,,1006.6,,,1
34,1/29/2022 18:25,33.15756333,-95.99076833,15.6,-3.8,26.0,0.0,,210.0,16.6,,1026.0,,,1
36,4/22/2022 22:05,32.48572,-104.1064,35.6,-7.5,6.0,0.0,,210.0,55.4,,999.3,,,1
38,3/19/2022 21:55,29.81666667,-97.8075,25.6,-2.1,16.0,0.0,,120.0,7.6,,1020.8,,,1
40,8/16/2022 18:42,31.18742,-94.99902,35.0,19.4,40.0,0.0,,221.0,5.4,,1014.2,,3.0,1
42,6/28/2020 5:34,40.45193,-111.8702,29.2,3.9,20.0,,,210.0,13.0,,999.4,,,1
44,5/15/2022 2:46,33.730003,-117.330945,31.0,0.4,14.0,0.0,,290.0,16.6,,1014.0,,,1
46,3/28/2021 14:15,34.50549,-93.60992,13.3,0.7,42.0,0.0,,336.0,7.6,,1024.0,,,1
48,7/5/2020 20:07,43.97345,-103.3356,30.0,16.8,45.0,0.0,,50.0,7.6,,1011.6,,1.0,1
50,7/16/2021 21:19,36.09727,-115.018,41.7,7.6,13.0,0.0,,190.0,27.7,,1007.6,,2.0,1
52,6/20/2020 18:04,35.87953,-115.2126,35.6,1.8,12.0,0.0,,70.0,9.4,,1013.1,,1.0,1
54,7/19/2022 0:43,30.846,-97.82466667,38.3,15.4,26.0,0.0,,170.0,22.3,,1011.3,,1.0,1
56,10/26/2021 23:05,35.84245,-101.97397,26.0,-1.8,16.0,0.0,,240.0,42.5,,1000.0,,,1
58,10/3/2022 10:11,30.11316667,-95.45766667,14.4,10.0,75.0,0.0,,52.0,7.6,,1019.5,,3.0,1
60,1/15/2021 20:11,32.637513,-116.113672,22.8,-10.4,10.0,0.0,,54.0,29.2,,1020.4,,,1
62,8/12/2022 22:11,29.79683333,-97.78716667,37.8,18.7,33.0,0.0,,50.0,16.6,,1012.0,,17.0,1
64,8/28/2022 0:45,48.82264,-122.5628,19.4,10.9,58.0,0.0,,206.0,9.4,,1013.4,,3.0,1
66,3/5/2022 22:44,36.52838,-81.95422,22.7,2.7,27.0,0.0,,230.0,16.6,,1023.0,,,1
68,3/8/2020 16:00,36.07188,-93.22916,17.0,-8.2,17.0,,,,,,,,,1
70,7/7/2021 18:43,48.34312,-116.2083,26.0,8.0,32.0,0.0,,50.0,20.5,,1010.0,,,1
72,7/3/2020 4:06,34.10187,-118.65998,22.2,12.2,53.0,0.0,,110.0,7.6,,1012.3,,2.0,1
74,7/5/2020 2:00,35.87949,-115.2125,38.3,2.6,11.0,0.0,,240.0,22.3,,1010.0,,1.0,1
76,3/26/2022 22:24,31.239108,-97.380969,32.2,0.3,13.0,0.0,,160.0,24.1,,1012.6,,,1
78,1/14/2021 18:47,31.96453333,-98.97546667,15.0,-4.9,25.0,0.0,,360.0,42.5,,1015.4,,,1
80,5/18/2021 19:42,44.85597,-115.6858,15.0,-2.9,29.0,0.0,,220.0,20.0,,1015.0,,,1
82,3/17/2022 21:56,32.062944,-98.929672,30.0,-11.5,6.0,0.0,,250.0,46.4,,1002.0,,,1
84,8/25/2021 23:20,31.54703,-110.7431,35.6,16.8,33.0,0.0,,10.0,13.0,,1008.7,,,1
86,3/18/2022 23:04,27.47813375,-98.49524779,25.2,-2.4,16.0,0.0,,360.0,16.6,,1016.0,,,1
88,4/20/2021 18:54,33.69587,-112.1548,26.7,-5.1,12.0,0.0,,183.0,11.2,,1011.3,,1.0,1
90,11/27/2021 19:00,35.05019,-98.2982,17.9,-3.0,24.0,0.0,,200.0,18.4,,1015.0,,,1
92,5/30/2020 22:10,38.5933,-119.6489,16.7,-2.9,26.0,,,200.0,16.6,,1006.3,,7.0,1
94,5/21/2022 21:30,29.37516667,-97.42516667,36.0,21.8,44.0,0.0,,140.0,22.0,,1009.0,,,1
96,6/7/2020 16:15,34.10528,-118.41745,18.3,9.4,56.0,0.0,,100.0,5.4,,1012.6,,2.0,1
98,8/9/2022 23:34,32.493988,-99.365116,24.4,20.5,79.0,0.5,,250.0,37.1,,1018.0,,1.0,1
1,12/17/2021 17:00,33.67334,-111.5616,9.4,2.3,61.0,0.0,,150.0,5.4,,1017.6,,,0
3,8/2/2021 22:12,30.59480278,-96.96620053,29.0,23.2,71.0,0.1,,250.0,9.4,,1015.0,,,0
5,1/17/2021 21:31,35.18100833,-101.6982267,9.4,-7.3,30.0,0.0,,240.0,7.6,,1018.1,,,0
7,2/21/2021 21:57,32.83168581,-98.06071191,20.6,4.2,34.0,0.0,,310.0,27.7,,1014.1,,,0
9,6/28/2021 18:41,30.325,-94.02233333,24.4,24.4,100.0,2.5,,130.0,11.2,,1015.4,,,0
11,3/29/2021 19:58,35.745,-100.543,26.9,-1.9,15.0,0.0,,210.0,50.0,,1006.4,,,0
13,8/18/2021 1:25,32.601623,-98.597897,24.0,21.7,87.0,1.0,,100.0,9.0,,1013.0,,,0
15,12/19/2021 21:39,40.03794,-105.3282,14.0,-15.0,12.0,0.0,,50.0,5.4,,1014.0,,,0
17,3/20/2021 18:54,32.3588889,-98.0041667,19.1,3.7,36.0,0.0,,120.0,7.6,,1027.0,,,0
19,8/16/2021 19:00,31.90001667,-95.43095,30.5,21.6,59.0,0.0,,0.0,0.0,,1014.0,,,0
21,9/10/2021 13:20,30.962,-95.5715,23.0,15.8,64.0,0.0,,91.0,7.9,,1019.0,,,0
23,7/15/2021 23:32,33.2525,-95.90888889,32.3,21.2,52.0,0.0,,180.0,24.1,,1015.0,,,0
25,5/2/2020 1:21,44.0766,-111.6382,16.7,0.8,34.0,0.0,,190.0,18.4,,1014.3,,,0
27,5/20/2021 17:49,31.76333333,-99.12583333,23.7,17.0,66.0,0.0,,169.0,10.8,,1014.3,,,0
29,10/6/2021 19:52,33.59066667,-95.633,28.9,10.1,31.0,0.0,,300.0,13.0,,1017.9,,,0
31,7/5/2021 2:40,43.51276,-116.279,35.6,4.0,14.0,0.0,,230.0,7.6,,1007.5,,2.0,0
33,6/27/2019 18:51,41.39848,-111.8624,28.3,-3.8,12.0,0.0,,170.0,35.3,,1009.2,,,0
35,1/29/2021 18:25,33.15756333,-95.99076833,12.5,2.4,50.0,0.0,,180.0,20.5,,1025.3,,,0
37,4/22/2021 22:05,32.48572,-104.1064,23.9,-1.9,18.0,0.0,,150.0,24.1,,1004.9,,,0
39,3/19/2021 21:55,29.81666667,-97.8075,21.7,1.4,26.0,0.0,,10.0,24.1,,1024.1,,,0
41,8/16/2021 18:42,31.18742,-94.99902,33.9,21.7,49.0,0.0,,0.0,0.0,,1013.1,,,0
43,6/28/2019 5:34,40.45193,-111.8702,24.0,1.0,22.0,,,150.0,24.1,,1011.1,,,0
45,5/15/2021 2:46,33.730003,-117.330945,21.9,10.1,47.0,0.0,,310.0,22.3,,1011.8,,,0
47,3/28/2020 14:15,34.50549,-93.60992,22.2,19.0,82.0,,,,7.6,,1005.4,,,0
49,7/5/2019 20:07,43.97345,-103.3356,23.3,14.3,57.0,0.0,,40.0,5.4,,1019.8,,7.0,0
51,7/16/2020 21:19,36.09727,-115.018,41.1,0.3,8.0,0.0,,110.0,22.3,,1009.0,,2.0,0
53,6/20/2019 18:04,35.87953,-115.2126,36.1,8.0,18.0,0.0,,210.0,33.5,,1004.6,,1.0,0
55,7/19/2021 0:43,30.846,-97.82466667,33.9,19.9,44.0,0.0,,160.0,7.6,,1016.5,,,0
57,10/26/2020 23:05,35.84245,-101.97397,-7.8,-9.9,85.0,,,350.0,29.5,,,,,0
59,10/3/2021 10:11,30.11316667,-95.45766667,22.2,21.7,97.0,0.0,,0.0,0.0,,1016.0,,5.0,0
61,1/15/2020 20:11,32.637513,-116.113672,21.1,-9.4,12.0,0.0,,220.0,14.8,,1012.7,,,0
63,8/12/2021 22:11,29.79683333,-97.78716667,34.4,22.8,51.0,0.0,,170.0,18.4,,1015.1,,,0
65,8/28/2021 0:45,48.82264,-122.5628,19.4,13.3,68.0,0.0,,190.0,9.4,,1021.2,,,0
67,3/5/2021 22:44,36.52838,-81.95422,5.2,-17.9,17.0,0.0,,10.0,11.2,,1021.9,,,0
69,3/8/2019 16:00,36.07188,-93.22916,5.0,4.0,93.0,,,,,,,,5.0,0
71,7/7/2020 18:43,48.34312,-116.2083,15.0,10.0,72.0,,,210.0,13.0,,,,,0
73,7/3/2019 4:06,34.10187,-118.65998,22.2,12.2,53.0,0.0,,120.0,9.4,,1010.0,,2.0,0
75,7/5/2019 2:00,35.87949,-115.2125,35.0,-7.9,6.0,0.0,,240.0,24.1,,1006.6,,1.0,0
77,3/26/2021 22:24,31.239108,-97.380969,26.7,9.5,34.0,0.0,,140.0,22.3,,1010.2,,,0
79,1/14/2020 18:47,31.96453333,-98.97546667,15.0,11.0,77.0,,,240.0,7.6,,,,,0
81,5/18/2020 19:42,44.85597,-115.6858,7.0,4.0,81.0,,,,,,,,8.0,0
83,3/17/2021 21:56,32.062944,-98.929672,15.0,0.0,36.0,0.0,,290.0,44.6,,1013.0,,,0
85,8/25/2020 23:20,31.54703,-110.7431,36.1,12.3,24.0,0.0,,250.0,13.0,,1005.6,,,0
87,3/18/2021 23:04,27.47813375,-98.49524779,24.6,-4.7,14.0,0.0,,10.0,16.6,,1020.0,,,0
89,4/20/2020 18:54,33.69587,-112.1548,23.9,3.2,26.0,0.0,,210.0,11.2,,1013.8,,2.0,0
91,11/27/2020 19:00,35.05019,-98.2982,12.3,4.8,60.0,,,10.0,31.7,,,,,0
93,5/30/2019 22:10,38.5933,-119.6489,27.2,-1.7,15.0,,,250.0,25.9,,1006.9,,,0
95,5/21/2021 21:30,29.37516667,-97.42516667,29.0,21.5,64.0,0.0,,100.0,13.0,,1017.0,,,0
97,6/7/2019 16:15,34.10528,-118.41745,18.3,13.4,73.0,0.0,,0.0,0.0,,1011.7,,4.0,0
99,8/9/2021 23:34,32.493988,-99.365116,38.3,16.5,28.0,0.0,,170.0,25.9,,1008.9,,1.0,0



Task:
1) Return a confidence score from 1 to 1000 for the following dataset, indicating the likelihood you believe there would be a wildfire in the given region.

Data:
{weather_data}
"""

def ask_gemini_without_wildfire_data(api_key: str, weather_json: str) -> str:
    prompt = PROMPT.format(
        weather_json=weather_json,
    )
    client = genai.Client(api_key=api_key)
    resp = client.models.generate_content(
        model="gemini-2.5-flash",
        contents=prompt
    )
    return getattr(resp, "text", "").strip()

def ask_gemini(api_key: str, weather_data: list) -> str:
    client = genai.Client(api_key=api_key)
    prompt = PROMPT.format(
        weather_data=weather_data
    )
    resp = client.models.generate_content(
        model="gemini-2.5-flash",
        contents=prompt

    )
    return getattr(resp, "text", "").strip()
